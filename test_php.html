<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHP Test Form - LOZUR</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #243B2D; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1a2d21; }
        .result { margin: 20px 0; padding: 15px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .debug { background: #f8f9fa; color: #495057; border: 1px solid #dee2e6; font-family: monospace; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>üß™ PHP Test Form - LOZUR</h1>
    <p>Use this form to test your PHP setup before going live.</p>
    
    <form id="testForm">
        <div class="form-group">
            <label for="fio">–§–ò–û (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤):</label>
            <input type="text" id="fio" name="fio" value="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" required>
        </div>
        
        <div class="form-group">
            <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω (+375XXXXXXXXX):</label>
            <input type="tel" id="phone" name="phone" value="+375291234567" required>
        </div>
        
        <div class="form-group">
            <label for="exp">–°—Ç–∞–∂ (–ª–µ—Ç, –º–∏–Ω–∏–º—É–º 2):</label>
            <input type="number" id="exp" name="exp" value="5" min="2" required>
        </div>
        
        <div class="form-group">
            <label>–î–æ–∫—É–º–µ–Ω—Ç—ã:</label>
            <label><input type="checkbox" name="docs" value="–ü–∞—Å–ø–æ—Ä—Ç" checked> –ü–∞—Å–ø–æ—Ä—Ç</label>
            <label><input type="checkbox" name="docs" value="–í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞" checked> –í–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞</label>
            <label><input type="checkbox" name="docs" value="–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞"> –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞</label>
        </div>
        
        <button type="submit">üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É</button>
    </form>
    
    <div id="result"></div>
    
    <hr>
    
    <h2>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h2>
    
    <h3>1. –í–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–∫—É</h3>
    <p>–í —Ñ–∞–π–ª–µ <code>send.php</code> –∏–∑–º–µ–Ω–∏—Ç–µ:</p>
    <pre><code>$DEBUG_MODE = false; // Set to true for debugging</code></pre>
    <p>–Ω–∞:</p>
    <pre><code>$DEBUG_MODE = true; // Set to true for debugging</code></pre>
    
    <h3>2. –í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫</h3>
    <p>–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫–∏ –≤ <code>send.php</code>:</p>
    <pre><code>ini_set('log_errors', 1);
ini_set('error_log', __DIR__ . '/php_errors.log');</code></pre>
    
    <h3>3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞</h3>
    <ul>
        <li>PHP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</li>
        <li>–§—É–Ω–∫—Ü–∏—è <code>mail()</code> –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞</li>
        <li>SMTP —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ</li>
    </ul>
    
    <h3>4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏</h3>
    <p>–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª <code>php_errors.log</code> –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.</p>

    <script>
        document.getElementById('testForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="info">–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å...</div>';
            
            const formData = new FormData(e.target);
            
            // –°–æ–±–∏—Ä–∞–µ–º —á–µ–∫–±–æ–∫—Å—ã
            const docs = Array.from(document.querySelectorAll('input[name="docs"]:checked'))
                .map(input => input.value);
            if (docs.length) {
                formData.append('docs_list', docs.join(', '));
            }
            
            try {
                const response = await fetch('send.php', {
                    method: 'POST',
                    body: formData
                });
                
                const responseText = await response.text();
                let data;
                
                try {
                    data = JSON.parse(responseText);
                } catch (parseError) {
                    throw new Error('–û—Ç–≤–µ—Ç –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º JSON: ' + responseText);
                }
                
                if (data.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h3>‚úÖ –£—Å–ø–µ—Ö!</h3>
                            <p>–ü–∏—Å—å–º–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ ${formData.get('fio')} (${formData.get('phone')})</p>
                            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—á—Ç—É: soloveymann@gmail.com</p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="error">
                            <h3>‚ùå –û—à–∏–±–∫–∞</h3>
                            <p><strong>–ö–æ–¥ –æ—Ç–≤–µ—Ç–∞:</strong> ${response.status}</p>
                            <p><strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> ${data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</p>
                        </div>
                    `;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                resultDiv.innerHTML += `
                    <div class="debug">
                        <h4>üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                        <p><strong>HTTP Status:</strong> ${response.status}</p>
                        <p><strong>Response Headers:</strong></p>
                        <pre>${Array.from(response.headers.entries()).map(([k,v]) => k + ': ' + v).join('\n')}</pre>
                        <p><strong>Raw Response:</strong></p>
                        <pre>${responseText}</pre>
                        <p><strong>Sent Data:</strong></p>
                        <pre>${Array.from(formData.entries()).map(([k,v]) => k + ': ' + v).join('\n')}</pre>
                    </div>
                `;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h3>üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞</h3>
                        <p><strong>–û—à–∏–±–∫–∞:</strong> ${error.message}</p>
                        <p>–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>
                        <ul>
                            <li>PHP –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ</li>
                            <li>–§–∞–π–ª send.php –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</li>
                            <li>–ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é</li>
                            <li>CORS –æ—à–∏–±–∫–∏</li>
                        </ul>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
